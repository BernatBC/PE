tu = c(0.3928104650003661, 0.38613866200103075, 0.38298730200040154, 0.3836100400003488, 0.38446171800023876, 0.38648577699859743, 0.3880880670003535, 0.39126112300073146, 0.3913192039981368, 0.39143634799984284,
       0.5941463680028392, 0.5978194109993638, 0.6000958990007348, 0.6174266479974904, 0.6114764659978391, 0.6052742159990885, 0.6063774850008485, 0.6076591560013185, 0.6072347629997239, 0.605932140002551,
       1.0092323099997884, 1.0377492130028259, 1.018105574999936, 1.0168260419995931, 1.0700137429994356, 1.0265347250024206, 1.0257282899983693, 1.0344504360000428, 1.0186306119976507, 1.0152296449996356,
       1.2308972630016797, 1.4365047570026945, 1.2328430479974486, 1.2540256879983644, 1.23260023200055, 1.4384445140021853, 1.4309636320031132, 1.233868880000955, 1.2330196219991194, 1.2194298460017308,
       2.6728919979977945, 2.6466648089990485, 2.6431999880005606, 2.6444571530009853, 2.694105665999814, 2.6978086060007627, 2.6593154429974675, 2.6565679920022376, 2.683303400001023, 2.642734171000484,
       3.646107745000336, 3.6738023340003565, 3.8685401610018744, 3.6627948220011604, 3.6828842840004654, 3.698112420999678, 3.6536567869989085, 3.6514857850015687, 3.6651766520008096, 3.6637670769996475,
       6.095307376999699, 6.433294025999203, 6.088375280000037, 6.35739769599968, 6.313441080998018, 6.096856126001512, 6.148383091000142, 6.103424116001406, 6.1642854059973615, 6.329313353002362,
       10.43963070600148, 10.670867131000705, 10.511210079002922, 10.524127229000442, 10.613739050000731, 10.556520229998569, 10.470421940997767, 10.85152145200118, 10.521694461000152, 10.556238698001835,
       13.467594155998086, 13.50144059000013, 13.780776005001826, 13.289006597002299, 13.36134642700199, 13.468484715001978, 13.759095815003093, 13.340606084002502, 13.32315439300146, 13.332875502997922,
       26.213422912998794, 25.28450629500003, 25.650899018000928, 25.452737540999806, 25.430792176000978, 25.593701723999402, 25.337706698999682, 26.195807776002766, 25.640305346001696, 25.1273522770025)

tw = c(0.08591600000000099, 0.06884939999999773, 0.08364780000000138, 0.06753369999999848, 0.06565009999999916, 0.06630610000000559, 0.06601419999999791, 0.06425370000000896, 0.08083370000002787, 0.08016530000000444,
       0.25995779999999513, 0.27242499999999836, 0.2677836999999954, 0.28024970000001304, 0.2764307000000201, 0.28842030000001273, 0.2682694000000083, 0.2827100999999743, 0.2615483000000154, 0.2734345000000076,
       0.8147506000000249, 0.776667400000008, 0.8179140999999959, 0.7965328999999883, 0.8087623000000121, 0.8029727999999636, 0.8140838999999573, 0.7939167000000111, 0.803889799999979, 0.800447800000029,
       1.1277521000000092, 1.1119950000000358, 1.111627799999951, 1.126531200000045, 1.128309399999921, 1.1289717999999311, 1.1137796000000435, 1.0938085000000228, 1.1575381000000107, 1.1038780999999744,
       2.585786999999982, 2.476835900000083, 2.4963325000001078, 2.482979099999966, 2.5527525999999625, 2.4936506000000236, 2.514798500000097, 2.470065399999953, 2.4743545999999697, 2.5436187000000245,
       3.684525200000053, 3.719213800000034, 3.836824399999955, 3.7310571000000436, 3.650232499999902, 3.7484018000000106, 3.6528604999999743, 3.718401999999969, 3.653249399999936, 3.751383300000043,
       6.2927603000000545, 6.264846000000034, 6.339046600000074, 6.448770700000068, 6.383027500000026, 6.364449899999954, 6.277007400000002, 6.283744200000001, 6.342126400000097, 6.407319799999868,
       11.039521599999944, 10.946878499999912, 10.93084419999991, 11.014599699999962, 11.056521199999906, 10.91438879999987, 10.880907799999932, 14.962613200000078, 10.96586400000001, 11.135259899999937,
       18.180663500000037, 14.166438700000072, 14.114150999999993, 14.096150200000011, 13.957862500000147, 14.125394799999867, 14.092164899999943, 14.101538000000119, 14.929516199999853, 13.946655899999996,
       26.479466499999944, 26.48343970000019, 26.38855109999986, 26.8889979999999, 26.639894800000093, 26.471626300000025, 26.424158499999976, 27.22346440000001, 26.713380799999868, 26.433829699999933)

px = c(217217, 217217, 217217, 217217, 217217, 217217, 217217, 217217, 217217, 217217, 
       486209, 486209, 486209, 486209, 486209, 486209, 486209, 486209, 486209, 486209, 
       1053360, 1053360, 1053360, 1053360, 1053360, 1053360, 1053360, 1053360, 1053360, 1053360, 
       1309100, 1309100, 1309100, 1309100, 1309100, 1309100, 1309100, 1309100, 1309100, 1309100, 
       2172573, 2172573, 2172573, 2172573, 2172573, 2172573, 2172573, 2172573, 2172573, 2172573, 
       2712200, 2712200, 2712200, 2712200, 2712200, 2712200, 2712200, 2712200, 2712200, 2712200, 
       3713346, 3713346, 3713346, 3713346, 3713346, 3713346, 3713346, 3713346, 3713346, 3713346, 
       5020371, 5020371, 5020371, 5020371, 5020371, 5020371, 5020371, 5020371, 5020371, 5020371, 
       5692248, 5692248, 5692248, 5692248, 5692248, 5692248, 5692248, 5692248, 5692248, 5692248, 
       8018100, 8018100, 8018100, 8018100, 8018100, 8018100, 8018100, 8018100, 8018100, 8018100)

logtu = log(tu)
logtw = log(tw)
logpx = log(px)

summary(tu)
summary(tw)

tD = tu - tw
sD = sd(tD)
sDu = sd(tu); sDw = sd(tw)
covu = cov(logtu, px); covu
covw = cov(logtw, px); covw
coru = cor(logtu, px); coru
corw = cor(logtw, px); corw
meanD = mean(tD)
length(tD)

#EstadÃ­stic
T = (meanD-0)/(sD/sqrt(n)); T

#Distribució
distr = qt(0.95, n - 1); distr

#pvalor
pvalor = pt(T, 0.95)

#IC 95%
ic<-c(meanD - qnorm(0.95)*sqrt(sD*sD/n), meanD + qnorm(0.95)*sqrt(sD*sD/n))


#GrÃ fic dades
plot(px, tu, type="p", col="red", xlab = "N? Pixels", ylab = "Temps execuci? (s)")
points(px, tw, col="blue") # DADES

modelu <- lm(logtu ~ logpx)
modelw <- lm(logtw ~ logpx)

#Boxplot
boxplot(tu, tw, names=c("Ubuntu", "Windows"), ylab="Temps (s)");

BlandAltmanLeh::bland.altman.plot(tw, tu, ylab="Difer?ncia en d'execuci? en segons Windows respecte Ubuntu", xlab="Temps execucio en segons")

#recta regressiÃ³ Ubuntu
plot(logpx, logtu, main="Ubuntu", ylab = "Temps (s)", xlab="P?xels");
abline(modelu, col = "red");

#recta regressiÃ³ Windows
plot(logpx, logtw, main="Windows", ylab = "Temps (s)", xlab="P?xels");
abline(modelw, col = "red");

#Normal Q-Q Ubuntu
qqnorm(logtu, logpx, main="Normal Q-Q Ubuntu", ylab = "Quantils", xlab="Quantils te?rics", ylim=c(0, 10))
qqline(logtu, col="red")

#Normal Q-Q Windows
qqnorm(logtw, logpx, main="Normal Q-Q Windows", ylab = "Quantils", xlab="Quantils te?rics", ylim=c(0, 10))
qqline(logtw, col="red")

hist(logtu,main="Histograma Ubuntu",xlab="Temps",ylab="N? d'ocurr?ncies")
hist(logtw,main="Histograma Windows",xlab="Temps",ylab="N? d'ocurr?ncies")

plot(fitted(modelu), resid(modelu), ylim=c(-1, 1)); abline(0,0, lty = 5)
plot(fitted(modelw), resid(modelw), ylim=c(-1, 1)); abline(0,0, lty = 5)

plot(modelu, c(2,1)) # Ubuntu residual vs fitted and QQnorm
plot(modelw, c(2,1)) # Windows residual vs fitted and QQnorm

plot(1:100, rstandard(modelu), type="l"); abline(0,0, lty = 5); points(rstandard(modelu)) # Ubuntu Ordre dels residus
plot(1:100, rstandard(modelw), type="l"); abline(0,0, lty = 5); points(rstandard(modelw)) # Windows Ordre dels residus


############# 